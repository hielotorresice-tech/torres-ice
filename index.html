<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Torres Ice - Venta de Hielo</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00aaff">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:url("fondo-hielo.png") center/cover no-repeat fixed;
}

.app{
  max-width:420px;
  margin:auto;
  min-height:100vh;
  background:rgba(255,255,255,0.78);
  backdrop-filter:blur(4px);
  padding:16px;
}

header{
  text-align:center;
  margin-bottom:14px;
}

header img{
  width:90px;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  text-align:center;
}

.qty{
  display:flex;
  justify-content:center;
  gap:12px;
  margin:12px 0;
}

.qty button{
  width:36px;
  height:36px;
  font-size:20px;
}

input, select{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:8px;
  border:1px solid #ccc;
}

.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  margin-top:10px;
  cursor:pointer;
}

.mp{ background:#FFD400; font-weight:bold; }
.tr{ background:#0072CE; color:white; }
.wa{ background:#25D366; font-weight:bold; }
.call{ background:#0288D1; color:white; }

.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  align-items:center;
  justify-content:center;
  z-index:999;
}

.modal-box{
  background:white;
  padding:20px;
  border-radius:14px;
  width:90%;
  max-width:360px;
  text-align:center;
}

/* ğŸ“² Banner instalar */
#installBanner{
  display:none;
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#0b5ed7;
  color:white;
  padding:15px 20px;
  border-radius:14px;
  box-shadow:0 8px 20px rgba(0,0,0,.3);
  max-width:90%;
  z-index:9999;
  text-align:center;
}
</style>
</head>

<body>

<div class="app">
<header>
  <img src="logo.png">
  <h2>Venta de Hielo Â· CopiapÃ³</h2>
  <small>ğŸšš Delivery disponible</small>
</header>

<div class="card">
<h3>Bolsa de Hielo 1 Kg</h3>
<h2>$500</h2>

<div class="qty">
  <button onclick="changeQty(-1)">âˆ’</button>
  <input id="qty" value="1" readonly>
  <button onclick="changeQty(1)">+</button>
</div>

<select id="zone" onchange="updateAll()">
  <option value="retiro">Retiro â€“ $0</option>
  <option value="centro">Centro â€“ $1.000 (+10 $0)</option>
  <option value="alrededores">Alrededores â€“ $1.200 (+10 $0)</option>
  <option value="paipote">Paipote â€“ $1.500 (+15 $0)</option>
  <option value="tierra">Tierra Amarilla â€“ $2.000 (+20 $0)</option>
</select>

<input id="customerName" placeholder="Nombre">
<input id="phone" placeholder="Celular">
<input id="address" placeholder="DirecciÃ³n">

<p>Subtotal: $<span id="subtotal">500</span></p>
<p>Delivery: $<span id="delivery">0</span></p>
<h3>Total: $<span id="total">500</span></h3>

<button class="btn mp" onclick="pagarMP()">ğŸ’³ Mercado Pago</button>
<button class="btn tr" onclick="openTransfer()">ğŸ¦ Transferencia</button>

<a id="whatsapp" class="btn wa" target="_blank">ğŸ“² WhatsApp Pedido</a>
<button class="btn call" onclick="location.href='tel:+56927731874'">ğŸ“ Llamar</button>
</div>
</div>

<!-- Modal transferencia -->
<div id="transfer" class="modal" onclick="if(event.target.id==='transfer')closeTransfer()">
  <div class="modal-box">
    <h3>Transferencia</h3>
    <p>Banco Coopeuch</p>
    <p>Cuenta Vista 251105735</p>
    <p>Oscar Torres</p>
    <button class="btn tr" onclick="closeTransfer()">Cerrar</button>
  </div>
</div>

<!-- ğŸ“² Banner instalar -->
<div id="installBanner">
  <strong>ğŸ“² Instala nuestra App</strong><br>
  Acceso rÃ¡pido y sin navegador
  <div style="margin-top:10px;">
    <button id="installBtn" class="btn mp">CÃ³mo instalar</button>
    <button id="closeInstall" style="background:none;border:none;color:white;font-size:18px">âœ•</button>
  </div>
</div>

<script>
const price = 500;

function changeQty(v){
  qty.value = Math.max(1, parseInt(qty.value) + v);
  updateAll();
}

function deliveryCost(q,z){
  if(z==="centro") return q>=10?0:1000;
  if(z==="alrededores") return q>=10?0:1200;
  if(z==="paipote") return q>=15?0:1500;
  if(z==="tierra") return q>=20?0:2000;
  return 0;
}

function updateAll(){
  const q = +qty.value;
  const d = deliveryCost(q, zone.value);
  subtotal.innerText = q * price;
  delivery.innerText = d;
  total.innerText = q * price + d;

  whatsapp.href =
   "https://wa.me/56927731874?text=" +
   encodeURIComponent(`Pedido hielo\nCantidad: ${q}\nTotal: $${q*price+d}`);
}

function pagarMP(){
  window.open("https://link.mercadopago.cl/torresice","_blank");
}

function openTransfer(){ transfer.style.display="flex"; }
function closeTransfer(){ transfer.style.display="none"; }

/* ğŸ“² Banner instalar manual (estable) */
window.onload = () => {
  if(!localStorage.getItem("installDismissed")){
    installBanner.style.display="block";
  }
};

installBtn.onclick = () => {
  alert(
    "Para instalar:\n\n" +
    "1ï¸âƒ£ Toca los 3 puntos (â‹®)\n" +
    "2ï¸âƒ£ Agregar a pantalla de inicio"
  );
};

closeInstall.onclick = () => {
  installBanner.style.display="none";
  localStorage.setItem("installDismissed","yes");
};

updateAll();
</script>

</body>
</html>
